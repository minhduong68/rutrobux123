<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Xổ Số Siêu Tốc</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        #theme-toggle {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .payment-section, .history-section {
            margin-bottom: 30px;
        }

        .payment-form input, .payment-form select, .payment-form button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .payment-form button {
            background-color: #007BFF;
            color: white;
            cursor: pointer;
        }

        .history-section ul {
            list-style-type: none;
            padding: 0;
        }

        .history-section li {
            background-color: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }

        .processing {
            color: orange;
        }

        .error-message {
            color: red;
            font-size: 12px;
            display: none;
        }

    </style>
</head>
<body>

    <button id="theme-toggle">Toggle Dark Mode</button>

    <div class="container">
        <!-- Payment Form -->
        <div class="payment-section">
            <h2>Nạp Robux bằng Thẻ Điện Thoại</h2>
            <form id="payment-form" class="payment-form">
                <select id="card-type" required>
                    <option value="Viettel">Viettel</option>
                    <option value="Mobifone">Mobifone</option>
                    <option value="Vinaphone">Vinaphone</option>
                </select>

                <select id="card-amount" required>
                    <option value="20000">20,000 VND</option>
                    <option value="50000">50,000 VND</option>
                    <option value="100000">100,000 VND</option>
                    <option value="200000">200,000 VND</option>
                    <option value="500000">500,000 VND</option>
                </select>

                <input type="text" id="card-code" placeholder="Nhập mã thẻ" required>
                <input type="text" id="serial-code" placeholder="Nhập mã seri" required>

                <div>
                    <select id="user-type" required>
                        <option value="username">Tên đăng nhập</option>
                        <option value="gamepass">Gamepass</option>
                    </select>
                </div>

                <div>
                    <input type="text" id="user-input" placeholder="Nhập tên đăng nhập hoặc game pass" required>
                </div>

                <div id="robux-amount-container">
                    <p id="calculated-robux">Số Robux nhận được: 0</p>
                </div>

                <button type="submit">Nạp Robux</button>
            </form>
            <div id="result">
                <p id="calculated-robux">Số Robux nhận được: 0</p>
                <p id="bonus-robux">Bonus: 0</p>
                <p id="processing-status" class="processing" style="display: none;">Robux đang xử lý...</p>
            </div>
            <p id="error-message" class="error-message">Mã thẻ hoặc mã seri không hợp lệ! Nếu cố tình sai, bạn sẽ mất thẻ.</p>
        </div>

        <!-- Transaction History -->
        <div class="history-section">
            <h2>Lịch Sử Nạp Robux</h2>
            <ul id="history-list"></ul>
        </div>
    </div>

    <script>
        // Toggle Dark Mode
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark');
        });

        // Load transaction history from localStorage
        const historyList = document.getElementById('history-list');
        
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('paymentHistory')) || [];
            historyList.innerHTML = '';
            history.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.cardType} - ${item.cardAmount} VND - Mã thẻ: ${item.cardCode} - Seri thẻ: ${item.serialCode} - ${item.robuxAmount} RB - Bonus: ${item.bonus} RB - Trạng thái: ${item.status}`;
                historyList.appendChild(li);
            });
        }

        loadHistory();

        // Handle payment form submission
        const paymentForm = document.getElementById('payment-form');
        const cardAmountInput = document.getElementById('card-amount');
        const cardTypeInput = document.getElementById('card-type');
        const cardCodeInput = document.getElementById('card-code');
        const serialCodeInput = document.getElementById('serial-code');
        const userTypeInput = document.getElementById('user-type');
        const userInput = document.getElementById('user-input');
        const calculatedRobux = document.getElementById('calculated-robux');
        const errorMessage = document.getElementById('error-message');
        const processingStatus = document.getElementById('processing-status');

        paymentForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const cardAmount = parseInt(cardAmountInput.value);
            const cardType = cardTypeInput.value;
            const cardCode = cardCodeInput.value;
            const serialCode = serialCodeInput.value;
            const userType = userTypeInput.value;
            const userValue = userInput.value;

            // Validate card code and serial code
            if (!/^\d+$/.test(cardCode) || !/^\d+$/.test(serialCode)) {
                errorMessage.style.display = 'block';
                return;
            }

            let robuxAmount = 0;
            let bonus = 0;

            // Calculate Robux and bonus based on card amount
            if (cardAmount === 20000) {
                robuxAmount = 2000;
            } else if (cardAmount === 50000) {
                robuxAmount = 5000;
                bonus = 1088; // Bonus for larger amounts
            } else if (cardAmount === 100000) {
                robuxAmount = 10000;
                bonus = 2000;
            } else if (cardAmount === 200000) {
                robuxAmount = 20000;
                bonus = 4000;
            } else if (cardAmount === 500000) {
                robuxAmount = 50000;
                bonus = 10000;
            }

            // Update the UI with calculated results
            calculatedRobux.textContent = `Số Robux nhận được: ${robuxAmount}`;

            // Show processing message
            processingStatus.style.display = 'block';

            // Save transaction history
            const now = new Date();
            const time = now.toLocaleString('vi-VN');
            const newTransaction = { 
                cardType, cardAmount, cardCode, serialCode, 
                robuxAmount, bonus, time, status: 'Đang xử lý' 
            };
            const history = JSON.parse(localStorage.getItem('paymentHistory')) || [];
            history.unshift(newTransaction);
            localStorage.setItem('paymentHistory', JSON.stringify(history));

            loadHistory();

            // Simulate sending request to admin (In a real app, it would be sent via an API)
            setTimeout(() => {
                // After sending to admin, we update status to "Đã duyệt nạp Robux"
                newTransaction.status = 'Đã duyệt nạp Robux';
                localStorage.setItem('paymentHistory', JSON.stringify(history));
                loadHistory();
                processingStatus.style.display = 'none'; // Hide processing status
            }, 3000); // Simulate 3 seconds of processing time

            // Reset the form
            paymentForm.reset();
        });
    </script>

</body>
</html>
